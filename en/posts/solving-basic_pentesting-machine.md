[Spanish](https://emersontech.github.io/index.html)|[Home](https://emersontech.github.io/en/index.html)|[Articles](https://emersontech.github.io/en/nav/page1.html)|[Author](https://emersontech.github.io/en/nav/about.html)|[Linkedin](https://www.linkedin.com/in/emersontech/)

# Solving the TryHackMe Basic Pentesting Machine

## Summary
The Basic Pentesting machine is an easy difficulty tryhackme platform machine. Its enumeration with the **nmap** tool shows us certain open ports with which we will exploit as we progress in the audit. Since we are in an audit and we find an **http** web service running on **open port 80 we can enumerate subdomains with wfuzz**. We are also revealed a **weak password vulnerability** of a certain user. Finally, we will achieve lateral privilege escalation by cracking **id_rsa keys using password cracking tools like zip2john.**

It is worth mentioning that for server reasons, tryhackme will change the IP address that we will be auditing.

We start the audit by checking the status of our target machine using a **ping** in order to check the response of our target.

![img](/img/BasicPentest/0.png)

The results have shown a **time to live (TTL = 61)** which indicates, thanks to proximity, that we are facing a Linux target.

Thanks to the **traceroute** utility we can monitor where our request travels, including the node server that functions as an intermediary between the communication:

![img](/img/BasicPentest/1.png)

We start with the reconnaissance phase using our nmap tool in the direction of our target machine using the parameters:

![img](/img/BasicPentest/2.png)

The result showed us different open ports, as we are facing a port 80 we access the http service within the **URL (Uniform Resource Locator).** Another port that is important to highlight is the **port 8080 http-proxy**. Which would indicate another way to access the web content.

In our second scan we add different parameters to have more information that can help us using the parameters:

![img](/img/BasicPentest/3.png)

Since we have nothing that catches our attention, we perform one last scan, this time analyzing each exposed port together with the script engine that comes by default in nmap:

![img](/img/BasicPentest/4.png)

What interests us at this point is that we found the versions on the **http port 80** service running **Apache 2.4.18, Apache Tomcat 9.0.7.**

Since we managed to find certain versions in the previous report, we can do a quick search on **searchsploit.**

![img](/img/BasicPentest/5.png)
![img](/img/BasicPentest/6.png)
![img](/img/BasicPentest/7.png)

With the information obtained, we already know that we cannot use **searchsploit** to find a potential attack route.

As we know that we are facing an **open http port 80** we manage to enter the ip address through the browser and arrive at a web page under maintenance:

![img](/img/BasicPentest/8.png)

If we apply an inspection of its source code we will not find any means of attack:

![img](/img/BasicPentest/9.png)

Before carrying out web fuzzing, it is necessary to analyze the technologies that run behind the web itself:

![img](/img/BasicPentest/10.png)

Since we are dealing with a web page, it is necessary to carry out a web fuzzing to find hidden content, this time we will use wfuzz and the first result we find is the /development directory.

![img](/img/BasicPentest/11.png)
![img](/img/BasicPentest/12.png)

Entering it directly in the URL we can notice certain files that are worth analyzing. Another important point to note in the previous screenshot is the version of apache that is being used **apache 2.4.18** even though we can also know this thanks to using **wappalyzer.**

When entering the file **dev.txt** we can notice the following text file:

![img](/img/BasicPentest/13.png)

While in the J.txt file we find:

![img](/img/BasicPentest/14.png)

In the previous text we managed to find a critical point in terms of breaking a **hash** easily, if we remember earlier we have an **open ssh port 22.**

As in the **nmap** scan above we noticed an exposed port **8080 http-proxy** we can enter it in the URL as **http://10.10.189.107:8080** to find any attack vector:

![img](/img/BasicPentest/15.png)

That took us directly to an Apache Tomcat 9.0.7 web server. Since it is not the same to apply web fuzzing to the IP 10.10.221.123 as 10.10.221.123:8080 (specifying the port), it is appropriate to do a web fuzzing again:

![img](/img/BasicPentest/16.png)
![img](/img/BasicPentest/17.png)

That showed us an interesting directory onwhich is manager that when entering it directly in the URL takes us to an authentication panel:

![img](/img/BasicPentest/18.png)

A repository on github directly provides us with credentials for apache tomcat which comes by default.

https://github.com/netbiosX/Default-Credentials/blob/master/Apache-Tomcat-Default-Passwords.mdown

![img](/img/BasicPentest/19.png)

After trying credentials we could not successfully enter the manager panel.

As we previously saw in our **nmap** scans we observed the **smb** service was open, so if we use the **smbclient** command that comes installed on linux and specify the **-L** parameter to listing the **hosts** we can see that the **sharename of Anonymous** is available:

![img](/img/BasicPentest/20.png)

A google search tells us how to connect from our kali machine to the share.

https://bestestredteam.com/2019/03/15/using-smbclient-to-enumerate-shares/

A tour inside the directory shows us the staff.txt file that we can download using the **get command**:

![img](/img/BasicPentest/21.png)

When opening the file with a cat we can see an announcement to the staff, which shows us exactly two names Kay and Jan.

![img](/img/BasicPentest/22.png)

As we analyzed previously, we know that there are weak credentials and we also have the presence of an exposed ssh port 20, which indicates an attack route. We use the credentials we have and try to connect to the ssh service.

![img](/img/BasicPentest/23.png)

After a few weak credential attempts we notice that we can't get access, that's why we will use **hydra** to crack this password as we know it is weak due to the letter to the **development department.**

With the help of the **hydra** tool we can perform a **password cracking together with the rockyou wordlist** and we effectively gain access to the user **Jan through the ssh protocol.**

![img](/img/BasicPentest/24.png)

We now know that the credentials for ssh access are given by jan:armando. Once the credentials are entered we can browse the file system.

**IMPORTANT NOTE: AT THIS POINT OF THE AUDIT THE IP ADDRESS WAS CHANGED DUE TO THE EXPIRATION TIME OF THE MACHINE. IT IS NOW IP 10.10.204.158**

![img](/img/BasicPentest/25.png)

At this point we carry out the typical recognition commands on the remote machine: whoami, sudo -l, hostname, id.

![img](/img/BasicPentest/26.png)

Since we don't have enough super user permissions, we are forced to attempt lateral privilege escalation. That is why by digging inside the files of the Kay directory we managed to find the id_rsa keys.

![img](/img/BasicPentest/27.png)
![img](/img/BasicPentest/28.png)
![img](/img/BasicPentest/29.png)

Since we are interested in extracting the **id_rsa** key, we can do it in different ways:

1. Use a command that is used to download files using the **ssh** protocol:
**scp (username)@(ip):(path_of_the_file) .
![img](/img/BasicPentest/30.png)

2. Copy & paste the id_rsa using nano:
![img](/img/BasicPentest/31.png)

As we can see we have our **id_rsa** that we downloaded directly from our victim, as well as the **key** file that we created using **nano.** Although it is more advisable to download the file with the first command.

Once the file is obtained, we are interested in passing our downloaded key, in this case I am using the same **id_rsa** to a plain text file to be able to carry out a **brute force attack with the john tool.**

In this case I am passing the key **id_rsa to an id.txt**

![img](/img/BasicPentest/32.png)

Using the john tool together with a wordlist in this case the famous rockyou wordlist and delivering the plain text file id.txt we start the attack.

![img](/img/BasicPentest/33.png)

Since we have an id_rsa key, it won't help us much to use the same password to enter only the kay user, since this key fulfills the function of a token. So in this case we grant chmod 600 permissions

![img](/img/BasicPentest/34.png)

Using the appropriate parameters we managed to enter the user kay.

![img](/img/BasicPentest/35.png)

Looking inside the files, we cat the pass.bak file and get the flag.

![img](/img/BasicPentest/36.png)

### Social Media

![img](/img/linkedin.png)|[Linkedin](https://www.linkedin.com/in/emersontech/)|![img](/img/youtube.png)|[Youtube](https://www.youtube.com/channel/UChNTj2xNpEQiliMv-IJbWvQ)|![img](/img/github.png)|[Github](https://github.com/emersontech)
